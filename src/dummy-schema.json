{
  "type": "record",
  "name": "DishwasherEvent",
  "namespace": "com.example.appliances",
  "doc": "Event schema for smart dishwasher telemetry and state transitions",
  "fields": [
    {
      "name": "event_id",
      "type": "string",
      "doc": "Unique identifier for the event"
    },
    {
      "name": "timestamp",
      "type": {
        "type": "long",
        "logicalType": "timestamp-millis"
      },
      "doc": "Event creation time"
    },
    {
      "name": "dishwasher_id",
      "type": "string",
      "doc": "Identifier of the dishwasher sending the event"
    },
    {
      "name": "event_type",
      "type": {
        "type": "enum",
        "name": "EventType",
        "symbols": [
          "CYCLE_STARTED",
          "CYCLE_COMPLETED",
          "DOOR_OPENED",
          "DOOR_CLOSED",
          "ERROR",
          "STATUS_UPDATE"
        ]
      },
      "doc": "Type of event"
    },
    {
      "name": "status",
      "type": [
        "null",
        {
          "type": "record",
          "name": "Status",
          "fields": [
            {
              "name": "temperature_celsius",
              "type": [
                "null",
                "float"
              ],
              "default": null
            },
            {
              "name": "water_level_liters",
              "type": [
                "null",
                "float"
              ],
              "default": null
            },
            {
              "name": "remaining_minutes",
              "type": [
                "null",
                "int"
              ],
              "default": null
            },
            {
              "name": "door_locked",
              "type": "boolean"
            }
          ]
        }
      ],
      "default": null,
      "doc": "Nested record representing dishwasher status (unioned with null)"
    },
    {
      "name": "cycle_info",
      "type": [
        "null",
        {
          "type": "record",
          "name": "CycleInfo",
          "fields": [
            {
              "name": "cycle_name",
              "type": "string"
            },
            {
              "name": "phase",
              "type": "string"
            },
            {
              "name": "progress_percent",
              "type": "int"
            }
          ]
        }
      ],
      "default": null,
      "doc": "Cycle details when applicable"
    },
    {
      "name": "error_details",
      "type": [
        "null",
        {
          "type": "record",
          "name": "ErrorDetails",
          "fields": [
            {
              "name": "error_code",
              "type": "string"
            },
            {
              "name": "description",
              "type": "string"
            },
            {
              "name": "affected_sensors",
              "type": {
                "type": "array",
                "items": "string"
              },
              "doc": "List of sensors involved in the error"
            }
          ]
        }
      ],
      "default": null,
      "doc": "Error information when event_type is ERROR"
    },
    {
      "name": "metadata",
      "type": {
        "type": "map",
        "values": "string"
      },
      "default": {},
      "doc": "Additional dynamic metadata or context fields"
    }
  ]
}
